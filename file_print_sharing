Enable FP Sharing
Enable-NetAdapterBinding -Name "Network Adapter Name" -DisplayName "File and Printer Sharing for Microsoft Networks"

Disable FP Sharing
Disable-NetAdapterBinding -Name "Network Adapter Name" -DisplayName "File and Printer Sharing for Microsoft Networks"

Enable CMD
netsh advfirewall firewall set rule group="File and Printer Sharing" new enable=Yes

Disable CMD
netsh advfirewall firewall set rule group="File and Printer Sharing" new enable=No


Enable PS

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled True -Profile Any

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled True -Profile Domain

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled True -Profile Private

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled True -Profile Public

Disable PS

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled False -Profile Any

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled False -Profile Domain

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled False -Profile Private

Set-NetFirewallRule -DisplayGroup "File And Printer Sharing" -Enabled False -Profile Public



Network Profile
Get-NetConnectionProfile

Set-NetConnectionProfile -Name "Network-Name" -NetworkCategory Private

SMB1
Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol
Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol
Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol

Get-SmbServerConfiguration | Select EnableSMB1Protocol
Set-SmbServerConfiguration -EnableSMB1Protocol $false
Set-SmbServerConfiguration -EnableSMB1Protocol $true

https://learn.microsoft.com/en-us/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3?tabs=server
